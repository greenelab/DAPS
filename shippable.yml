# language setting
language: python
notifications:
   email: false
archive: true

python:
  - "3.4"

before_script:
  - cd /root/workspace/src/github.com/greenelab/DAPS

script:
  - which python
  - nose2 --plugin nose2.plugins.junitxml --junit-xml test 
  - mv nose2-junit.xml shippable/testresults/tests.xml
  - jupyter nbconvert --to html ./visualize/Figures.ipynb
  - cp Figures.html shippable/buildoutput/
  - coverage run --branch test.py
  - coverage xml -o shippable/codecoverage/coverage.xml test.py

after_success:
  - git checkout master
  - git merge --no-ff staging
  - git add -f .
  - git commit -m "Successful build from $COMMIT [skip ci]"
  - git push -fq release master